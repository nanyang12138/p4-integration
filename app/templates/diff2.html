{% extends "layout.html" %}
{% block content %}
<div class="bg-white rounded-xl shadow-sm border border-slate-200 flex flex-col h-[calc(100vh-140px)]">
  
  <!-- Header -->
  <div class="px-6 py-4 border-b border-slate-100 flex items-center justify-between bg-slate-50">
    <div>
      <div class="flex items-center gap-2 text-slate-800">
        <i class="fa-solid fa-columns text-primary-500"></i>
        <h3 class="font-mono text-sm font-semibold">{{ file }}</h3>
      </div>
      <p class="text-xs text-slate-500 mt-1">Three-way Diff View</p>
    </div>
    <a class="text-slate-500 hover:text-slate-800 text-xs font-medium transition-colors px-3 py-1.5 rounded border border-slate-200 bg-white hover:bg-slate-50" href="/admin/jobs/{{ job.id }}">
      <i class="fa-solid fa-arrow-left mr-1"></i> Back to Job
    </a>
  </div>

  <div class="flex-grow grid grid-cols-3 divide-x divide-slate-200 overflow-hidden">
    
    <!-- Merged -->
    <div class="flex flex-col bg-white">
      <div class="px-4 py-2 bg-slate-50 border-b border-slate-100 flex justify-between items-center">
        <span class="text-xs font-bold text-slate-700">Merged (-am)</span>
        <form method="post" action="/admin/jobs/{{ job.id }}/resolve">
          <input type="hidden" name="mode" value="merge" />
          <input type="hidden" name="files" value="{{ file }}" />
          <button class="px-2 py-1 bg-blue-50 text-blue-700 hover:bg-blue-100 rounded text-[10px] font-medium border border-blue-200 transition-colors" type="submit">Apply</button>
        </form>
      </div>
      <div class="flex-grow overflow-auto">
        <pre class="p-3 text-[10px] font-mono text-slate-600 leading-relaxed whitespace-pre-wrap">{{ merged }}</pre>
      </div>
    </div>

    <!-- Theirs -->
    <div class="flex flex-col bg-white">
      <div class="px-4 py-2 bg-slate-50 border-b border-slate-100 flex justify-between items-center">
        <span class="text-xs font-bold text-slate-700">Theirs (-at)</span>
        <form method="post" action="/admin/jobs/{{ job.id }}/resolve">
          <input type="hidden" name="mode" value="accept-theirs" />
          <input type="hidden" name="files" value="{{ file }}" />
          <button class="px-2 py-1 bg-slate-100 text-slate-700 hover:bg-slate-200 rounded text-[10px] font-medium border border-slate-200 transition-colors" type="submit">Apply</button>
        </form>
      </div>
      <div class="flex-grow overflow-auto">
        <pre class="p-3 text-[10px] font-mono text-slate-600 leading-relaxed whitespace-pre-wrap">{{ theirs }}</pre>
      </div>
    </div>

    <!-- Yours -->
    <div class="flex flex-col bg-white">
      <div class="px-4 py-2 bg-slate-50 border-b border-slate-100 flex justify-between items-center">
        <span class="text-xs font-bold text-slate-700">Yours (-ay)</span>
        <form method="post" action="/admin/jobs/{{ job.id }}/resolve">
          <input type="hidden" name="mode" value="accept-yours" />
          <input type="hidden" name="files" value="{{ file }}" />
          <button class="px-2 py-1 bg-slate-100 text-slate-700 hover:bg-slate-200 rounded text-[10px] font-medium border border-slate-200 transition-colors" type="submit">Apply</button>
        </form>
      </div>
      <div class="flex-grow overflow-auto">
        <pre class="p-3 text-[10px] font-mono text-slate-600 leading-relaxed whitespace-pre-wrap">{{ yours }}</pre>
      </div>
    </div>

  </div>
</div>
{% endblock %}
